import couchdb
import numpy as np

server = couchdb.Server('http://localhost:9000')
#server = couchdb.Server()
tagdb = server['tags']
tags = tagdb['a2fa8c775de9bc7d97ea22c5a9135649']['items']

db = server['questions']

counter = 0
for tagname in tags:
	counter+=1
	tmplist = []
	for i in db:
		for j in db[i]['items']:
			if j['name']['name'] == tagname['name']:
				tmplist.append(j['total'])

	print tagname['name'], tmplist

#data is from 2015 -->> 2010
#java
a = [16221, 18003, 17903, 16794, 15810, 17371, 15809, 17655, 21204, 22429, 19290, 17130, 16102, 17470, 17286, 15107, 13850, 14003, 12970, 14156, 15141, 14786, 12931, 12774, 11580, 13059, 13008, 11199, 11869, 11879, 10719, 11723, 11654, 12034, 10609, 9807, 8874, 9366, 8360, 8135, 8559, 8031, 7847, 8532, 7873, 8496, 6891, 6560, 5679, 5595, 5036, 4725, 4740, 4501, 4287, 4154, 3875, 4426, 3569, 3681]

#javascript
b = [16987, 18529, 19373, 18334, 18716, 20233, 18300, 19919, 22055, 23440, 21715, 19796, 16824, 17346, 18541, 16611, 15716, 15666, 13673, 14012, 14559, 14506, 13030, 13040, 11094, 11734, 11778, 10656, 11884, 11812, 10831, 11121, 10304, 10329, 9613, 9322, 8087, 8416, 7801, 7996, 8696, 7863, 7512, 7211, 6894, 6725, 5561, 5390, 4924, 4529, 4101, 4000, 3981, 3822, 3439, 3178, 2969, 2925, 2603, 2571]

#angularjs
c = [4417, 4619, 4784, 4545, 4434, 4580, 3888, 3768, 3717, 3742, 3235, 2823, 2097, 2141, 2198, 1944, 1901, 1637, 1243, 1228, 1115, 914, 678, 603, 342, 304, 287, 187, 173, 97, 74, 33, 10, 7, 3, 1, 1, 1, 3, 2, 1, 2, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

#ruby-on-rails-3
d = [238, 221, 239, 242, 360, 357, 386, 400, 445, 519, 549, 508, 522, 578, 714, 791, 922, 886, 1079, 1173, 1194, 1408, 1367, 1497, 1256, 1393, 1458, 1233, 1490, 1475, 1400, 1574, 1431, 1437, 1376, 1404, 1189, 1165, 1144, 1284, 1715, 1451, 1367, 1448, 1218, 1402, 1033, 985, 645, 554, 489, 328, 151, 97, 81, 55, 31, 37, 19, 4]

#node.js 
e = [2454, 2580, 2624, 2483, 2612, 2644, 2407, 2544, 2419, 2742, 2394, 2175, 1886, 1795, 1659, 1512, 1637, 1557, 1269, 1391, 1251, 1421, 1152, 1201, 966, 1002, 989, 823, 1019, 904, 817, 834, 812, 736, 616, 688, 602, 462, 378, 525, 467, 354, 346, 338, 357, 235, 163, 134, 108, 89, 83, 71, 40, 44, 15, 19, 14, 9, 5, 1]

num = 20

l = [a, b, c, d, e]
    
def trends(j):
    pos = 0
    neg = 0
    for i in range(num-1):
        #print j[i] - j[i+1]
        if j[i] - j[i+1] < 0:
            neg+=1
        else:
            pos+=1
    print 'pos:', pos, 'neg:', neg
    if pos > neg:
        print 'up'
    elif pos < neg:
        print 'down'
    else:
        print '=='

for j in l:
    print "\n",j[:num]
    trends(j)